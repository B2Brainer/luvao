# ğŸ—ï¸ Imagen base (Node 20 con npm)
FROM node:20

# ğŸ“‚ Crea el directorio de trabajo dentro del contenedor
WORKDIR /usr/src/app

# ğŸ“¦ Copia los archivos de configuraciÃ³n primero (para aprovechar la cachÃ© de Docker)
COPY package*.json ./

# ğŸ“¥ Instala las dependencias
RUN npm install

# ğŸ“‹ Copia el resto del cÃ³digo fuente
COPY . .

# ğŸ§  Genera el cliente de Prisma (para que el servicio pueda acceder a la base)
RUN npx prisma generate

# ğŸ”§ Compila el cÃ³digo TypeScript a JavaScript
RUN npm run build

# ğŸŒ Expone el puerto interno del servicio
EXPOSE 3001

# ğŸš€ Comando de inicio del contenedor (modo producciÃ³n)
CMD ["npm", "run", "start"]
